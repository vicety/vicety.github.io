

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/vicety/Images@master/images/momiji-ico.ico">
  <link rel="icon" href="https://cdn.jsdelivr.net/gh/vicety/Images@master/images/momiji-ico.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="vicety">
  <meta name="keywords" content="">
  
    <meta name="description" content="BigTable 论文阅读">
<meta property="og:type" content="article">
<meta property="og:title" content="Bigtable: A Distributed Storage System for Structured Data">
<meta property="og:url" content="https://vicety.github.io/2022/10/22/BigTable/index.html">
<meta property="og:site_name" content="vicety的博客">
<meta property="og:description" content="BigTable 论文阅读">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/vicety/Images/master/images20220904031156.png">
<meta property="article:published_time" content="2022-10-22T18:24:00.000Z">
<meta property="article:modified_time" content="2023-02-09T04:27:58.946Z">
<meta property="article:author" content="vicety">
<meta property="article:tag" content="加密">
<meta property="article:tag" content="论文阅读">
<meta property="article:tag" content="分布式">
<meta property="article:tag" content="存储">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/vicety/Images/master/images20220904031156.png">
  
  
  
  <title>Bigtable: A Distributed Storage System for Structured Data - vicety的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"vicety.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 90vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>vicety的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://raw.githubusercontent.com/vicety/Images/master/images72055179_p0.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Bigtable: A Distributed Storage System for Structured Data"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-10-22 20:24" pubdate>
          2022年10月22日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          35 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Bigtable: A Distributed Storage System for Structured Data</h1>
            
            
              <div class="markdown-body">
                
                <p>pid&#x3D;72055179</p>
<p>文章没有 GFS 好懂，部分内容是推测的</p>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><ul>
<li>数据级别：Set（新增或修改）、Delete、CAS、批量接口（非事务）</li>
<li>Metadata 级别：（增删 column family、table）</li>
<li>以及访问权限配置</li>
</ul>
<h3 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">tablet server=Set[tablet]<br>    len between (<span class="hljs-number">10</span>, <span class="hljs-number">1000</span>) <br>    size between (<span class="hljs-number">100</span>M, <span class="hljs-number">200</span>M)<br>table=List[tablet] <span class="hljs-comment">// initially one tablet, will split when growing </span><br>    METADATA table=List[METADATA tablet]<br>tablet=Row Range Segment=Data<br>TODO tablet和SSTable的关系尚不明确 我的猜测是一个 tablet 对应一个 SSTable<br><span class="hljs-comment">// 数据按 Key 字典序存储（因此在应用层应尽量使可能同时访问的数据有相似的 key 以提升访问效率）（同时也可以应用类似于 LevelDB 的压缩策略）</span><br>Data=List[(Key, Value)]<br>Key=String<br>Value=List[ColFamily]<br>ColFamily=List[Cell]<br>Cell=List[(CellContent, Version)]<br></code></pre></td></tr></table></figure>

<p>举例：</p>
<p><img src="https://raw.githubusercontent.com/vicety/Images/master/images20220904031156.png" srcset="/img/loading.gif" lazyload></p>
<p>key：类似java包，因为key会排序，这样做有利于相关数据放在一起<br>名为anchor的column family：cnnsi.com 与 my.look.ca 都引用了 key，引用时使用名称 CNN、CNN.com<br>contents column family只有一列，但这一列中的这个cell存了三个网页版本</p>
<h3 id="与其他系统的关系"><a href="#与其他系统的关系" class="headerlink" title="与其他系统的关系"></a>与其他系统的关系</h3><ul>
<li>GFS 是 BigTable 的底层存储</li>
<li>有 wrapper 代码使 BigTable 可以作为 MapReduce 作业的输入与&#x2F;或输出</li>
<li>使用 基于 paxos 的 Chubby，它暴露文件 API（类似 ZK），BigTable 用它：<ol>
<li>选 master</li>
<li>存 root tablet</li>
<li>存表结构、ACL</li>
<li>使用类似 zk ephemeral 节点的功能检测 tablet server 上下线，同时 tablet server 也主动 watch 这个节点，如果 master 将文件删除，意味着这个 tablet server 不再</li>
</ol>
</li>
</ul>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>对应论文 ch5</p>
<p>BigTable 在实现上包括 client lib, master server, tablet server 三类组件</p>
<p>master server 功能：负责管理 tablet 与 tablet server 的映射关系<br>tablet server 功能：存多个 tablet</p>
<p>client 读写大部分时间直接与 tablet server 交互即可</p>
<blockquote>
<p>client data does not move through the master: clients communicate directly with tablet servers for<br>reads and writes</p>
</blockquote>
<p>本节剩余部分参考自[1]，对照论文确认过正确性</p>
<p>当master启动的时候，master需要完成以下步骤：</p>
<ul>
<li>在chubby上获取master锁。</li>
<li>扫描chubby server directory获取活跃的tabletServer。</li>
<li>获取每个活跃的tabletServer上分配的tablet</li>
<li>扫描所有的METADATA tablet获取所有的tablet，与3对比，可以获取未分配的tablet，进行分配。在扫描METADATA tablet的过程中，如果发现MEATADATA tablet还没有初始化，就新创建rootTablet和MEATADATA tablet，进行初始化。</li>
</ul>
<p>tablet在四种情况下会发生变化：创建、删除、合并和分裂。这四种变化中，前三种是由master发起的，最后一种是由chunkServer发起的。tablet的分裂实际上不涉及到数据的移动，只涉及到元数据的更改。chunkServer在对应的METADATA进行元数据的更改和插入，就可以完成分裂操作，然后通知master这个分裂操作。如果这个通知失败了，通过后续的心跳信息，master也很容易知道知道tablet的最新情况。tablet分裂的细节请参考tabletServer一节。</p>
<p>master 负责 tablet 的调度，Bigtable 的数据是存储在GFS上的，数据的调度由GFS负责，<strong>master 调度更多是让 memtable 在 tabletServer 间均衡分布</strong>。</p>
<h4 id="索引设计"><a href="#索引设计" class="headerlink" title="索引设计"></a>索引设计</h4><p>全局的所有数据（跨table）使用三层树状结构维护，类似于 B+ 树，每层都以 tablet 的形式存，数据足够多会导致 tablet 分裂。第一层只有一个 root tablet，维护指向第二层 metadata tablet 的指针列表，永不分裂，root tablet 的位置在 Chubby 中维护；第二层是 metadata tablet，内部每行指向第三层的 tablet；第三层的 tablet 对应某个 table 下的某个 tablet。（我的理解）tablet 的尾部存了 tablet 内部的索引，读到内存，使得 tablet 内部查询仅走一次随机IO（另一个可选项是将整个 tablet 都读到内存）。另，Client 会缓存索引，避免每次都查索引</p>
<h4 id="SSTable-管理"><a href="#SSTable-管理" class="headerlink" title="SSTable 管理"></a>SSTable 管理</h4><p>Memtable + WAL + minor compaction （定期 memtable 落盘，我的理解等同于论文中的 redo point）+ 定期 schedule major compaction（合并多个 sstable）</p>
<h4 id="工程优化"><a href="#工程优化" class="headerlink" title="工程优化"></a>工程优化</h4><p>来自论文第六节</p>
<p>如果为每个 tablet 维护一个 WAL，由于这些 tablet 可能被调度到不同的 GFS chunk server，多个 tablet 修改产生的 WAL 插入在写入上可能不是顺序写入，（换句话说，单个 tablet server 维护 N 个 tablet，如果全 table 随机写入，这些写入就会转化为 N 个 WAL 文件的顺序写入），论文提出对每个 tablet server 维护一个 WAL（即使维护 N 个 tablet，仍然只写一个 WAL，但是这个 WAL 是所有 tablet server 维护的 tablet 的 WAL 混合起来的，也就是 GFS 的 conrrent + append 场景），但 tablet 恢复过程中需要过滤出此 tablet 写入的 WAL。BigTable 使用的 WAL 格式是 <code>⟨table, row name, log sequence number⟩</code>，其中包含了 GFS 读取时应用层需要的去重功能</p>
<h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><p>TODO<br>宽列模式的优势？<br>选主流程？理论上可以类比利用 zk 实现选主，监听前缀节点即可</p>
<h3 id="Explain-the-finding-process-of-tablets-in-BigTable"><a href="#Explain-the-finding-process-of-tablets-in-BigTable" class="headerlink" title="Explain the finding process of tablets in BigTable"></a>Explain the finding process of tablets in BigTable</h3><p>（来自 KTH DD2221 HW1)</p>
<p>BigTable maintains a METADATA table, in which each row encodes the information (tablet identifier, end row) to find the tablet. A root tablet maintains the location of all tablets in METADATA tablet, and the location of the root tablet is maintained as a file in Chubby.</p>
<p>Clients first need to get the location of root tablet from Chubby, then find the METADATA tablet matching the key that client is reading or writing, then find the row in that METADATA tablet matching the key that client is reading or writing, finally, find the tablet that stores the data from the tablet identifier stored in the row. The client can cache these information so later read&#x2F;write won’t need these steps.</p>
<h3 id="关于宽列数据库"><a href="#关于宽列数据库" class="headerlink" title="关于宽列数据库"></a>关于宽列数据库</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://db-engines.com/en/article/Wide+Column+Stores">https://db-engines.com/en/article/Wide+Column+Stores</a><br>Wide column stores, also called extensible record stores, store data in records with an ability to hold very large numbers of dynamic columns. Since the column names as well as the record keys are not fixed, and since a record can have billions of columns, wide column stores can be seen as two-dimensional key-value stores.<br>(与 列式存储 的区别)<br>Wide column stores must not be confused with the column oriented storage in some relational systems. This is an internal concept for improving the performance of an RDBMS for OLAP workloads and stores the data of a table not record after record but column by column.</p>
</blockquote>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>介绍了一个分布式宽列数据库的设计思路</li>
<li>将 GFS 封装为 SSTable 使用，同时引入配套需要的 Memtable、WAL、Compaction、聚簇索引（三层，类似 B+ 树，用于根据 key 找 tablet）、表结构&#x2F;ACL 维护</li>
<li>Metadata 使用 Chubby 维护</li>
<li>Memtable 的调度</li>
</ul>
<p>总结的总结：分布式宽列数据库，存储层使用 GFS，<br>数据安全已经在 GFS 层解决，本层主要解决引入的 metadata 的安全 和</p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><ol>
<li><a target="_blank" rel="noopener" href="https://niceaz.com/2019/03/24/bigtable/#%E5%85%B3%E4%BA%8E%E8%B7%A8%E8%A1%8C%E4%BA%8B%E5%8A%A1">Bigtable论文阅读总结</a><br>TODO 其中还讨论了 Percolator 在 BitTable 单行事务基础上实现的多行事务，值得学习一下</li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%8A%80%E6%9C%AF/" class="category-chain-item">技术</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%8A%A0%E5%AF%86/">#加密</a>
      
        <a href="/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">#论文阅读</a>
      
        <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/">#分布式</a>
      
        <a href="/tags/%E5%AD%98%E5%82%A8/">#存储</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Bigtable: A Distributed Storage System for Structured Data</div>
      <div>https://vicety.github.io/2022/10/22/BigTable/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>vicety</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年10月22日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/03/12/%E5%9C%A8%20Apache%20Calcite%20%E4%B8%AD%E4%BD%BF%E7%94%A8UDF/" title="在 Apache Calcite 中使用 UDF">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">在 Apache Calcite 中使用 UDF</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10/09/%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5%E9%A1%BA%E5%BA%8F/" title="静态链接的链接顺序">
                        <span class="hidden-mobile">静态链接的链接顺序</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.4.17/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"p7Skzx1UifgNosmr5ms2nILv-gzGzoHsz","appKey":"W73NSV1s3dRPtfceJDBsX5uP","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
